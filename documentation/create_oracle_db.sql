-- Oracle DB creation script for DRDL Fire Management System
-- Replace PASSWORD_PLACEHOLDER with a secure password before running

-- 1) Create user/schema
CREATE USER DRDL_USER IDENTIFIED BY "PASSWORD_PLACEHOLDER";
GRANT CREATE SESSION, CREATE TABLE, CREATE SEQUENCE, CREATE VIEW, CREATE PROCEDURE, CREATE TRIGGER TO DRDL_USER;
ALTER USER DRDL_USER QUOTA UNLIMITED ON USERS;

-- 2) Create tables (run as a privileged user or connect as DRDL_USER after creating user)
-- EMPLOYEE_DETAILS table
CREATE TABLE DRDL_USER.EMPLOYEE_DETAILS (
  EMP_ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
  EMPLOYEE_NAME VARCHAR2(100 CHAR) NOT NULL,
  PERSONNEL_NO VARCHAR2(6 CHAR) NOT NULL UNIQUE,
  DESIGNATION VARCHAR2(100 CHAR) NOT NULL,
  DIRECTORATE VARCHAR2(100 CHAR),
  DIVISION VARCHAR2(100 CHAR),
  ADDRESS VARCHAR2(300 CHAR),
  PHONE VARCHAR2(15 CHAR),
  EMAIL VARCHAR2(100 CHAR),
  PASSWORD VARCHAR2(255 CHAR),
  STATUS VARCHAR2(20 CHAR)
);

-- SAFETY_REQUEST table
CREATE TABLE DRDL_USER.SAFETY_REQUEST (
  REQUEST_ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
  UNIQUE_ID VARCHAR2(12 CHAR) UNIQUE,
  PERS_NO VARCHAR2(6 CHAR) NOT NULL,
  DATE_OF_REQUEST DATE,
  SAFETY_COVERAGE VARCHAR2(50 CHAR) NOT NULL,
  DIRECTORATE VARCHAR2(100 CHAR),
  DIVISION VARCHAR2(100 CHAR),
  INTEGRATION_FAC VARCHAR2(100 CHAR),
  ARTICLE_DETAILS VARCHAR2(500 CHAR),
  WORK_DESCRIPTION VARCHAR2(500 CHAR),
  ACT_INCHARGE_NAME VARCHAR2(100 CHAR),
  ACT_INCHARGE_ORG VARCHAR2(100 CHAR),
  ACT_INCHARGE_PHONE VARCHAR2(15 CHAR),
  DESIGNATION VARCHAR2(100 CHAR),
  ACTIVITY_FROM_DATE DATE,
  ACTIVITY_TO_DATE DATE,
  ACTIVITY_SCHEDULE VARCHAR2(3 CHAR),
  ACTIVITY_PDF BLOB,
  AMBULANCE_REQUIRED VARCHAR2(3 CHAR),
  OTHER_DETAILS VARCHAR2(500 CHAR),
  TEST_BED VARCHAR2(100 CHAR),
  TARB_CLEARANCE VARCHAR2(100 CHAR),
  REFERENCE_NO VARCHAR2(100 CHAR),
  TEST_CTRL_NAME VARCHAR2(100 CHAR),
  TEST_CTRL_DESIG VARCHAR2(100 CHAR),
  DATE_OF_TEST DATE,
  TEST_SCHEDULE_TIME VARCHAR2(8 CHAR),
  WORK_CENTRE VARCHAR2(100 CHAR),
  TRANSPORTATION VARCHAR2(100 CHAR),
  TRANS_SCHEDULE_TIME VARCHAR2(8 CHAR),
  TRANS_INCHARGE VARCHAR2(100 CHAR),
  VEHICLE_DETAILS VARCHAR2(100 CHAR),
  DRIVER_NAME VARCHAR2(100 CHAR),
  DRIVER_DESIG VARCHAR2(100 CHAR),
  DRIVER_AUTH VARCHAR2(3 CHAR),
  HEAD_SFEED_STATUS VARCHAR2(20 CHAR),
  WORK_ALLOCATED_TO VARCHAR2(100 CHAR),
  GD_TS_STATUS VARCHAR2(20 CHAR)
);

-- 3) Example index for faster lookup by personnel number
CREATE INDEX IDX_SAFETY_PERSNO ON DRDL_USER.SAFETY_REQUEST (PERS_NO);
CREATE INDEX IDX_EMP_PERSONNEL_NO ON DRDL_USER.EMPLOYEE_DETAILS (PERSONNEL_NO);

-- 4) (Optional) Grant privileges if using separate application DB user
-- GRANT SELECT, INSERT, UPDATE, DELETE ON DRDL_USER.SAFETY_REQUEST TO SOME_APP_USER;

-- Notes:
-- - After running this script, set environment variables used by the app:
--   ORACLE_URL=jdbc:oracle:thin:@//<HOST>:1521/<SERVICE>
--   ORACLE_USER=DRDL_USER
--   ORACLE_PASSWORD=<PASSWORD_PLACEHOLDER>
-- - The app expects Oracle 12c+ for IDENTITY support. If using older versions, create sequences/triggers for IDs.
